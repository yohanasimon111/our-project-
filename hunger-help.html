<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hunger Help - HopeLink Mahama</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            blue: '#3B82F6',
                            green: '#10B981',
                            yellow: '#FBBF24',
                            light: '#FEF3C7'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    screens: {
                        'xs': '475px',
                        'lg-md': '1100px', // Custom breakpoint for small desktops
                    }
                }
            }
        }
    </script>
    <style>
        /* Professional navigation styles */
        .nav-professional {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }
        .nav-scrolled {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }
        .nav-item {
            position: relative;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-size: 14px;
            font-weight: 500;
        }
        .nav-item::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 50%;
            background: linear-gradient(90deg, #3B82F6, #10B981);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        .nav-item:hover::after {
            width: 100%;
        }
        .donate-btn {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
        }
        .donate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }
       
        /* Login and Signup button styles */
        .login-btn {
            background: transparent;
            border: 2px solid #3B82F6;
            color: #3B82F6;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-size: 14px;
            font-weight: 600;
        }
        .login-btn:hover {
            background: #3B82F6;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        .signup-btn {
            background: linear-gradient(135deg, #3B82F6, #2563EB);
            color: white;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-size: 14px;
            font-weight: 600;
        }
        .signup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
       
        /* Opportunities button specific styling */
        .opportunities-btn {
            background: #FBBF24;
            color: #1F2937;
            font-size: 13px;
            font-weight: 600;
            white-space: nowrap;
        }
        .opportunities-btn:hover {
            background: #F59E0B;
        }
       
        /* Logo text sizing */
        .logo-main {
            font-size: 20px;
            font-weight: 700;
        }
        .logo-sub {
            font-size: 11px;
            font-weight: 600;
        }
       
        /* Mobile navigation font sizes */
        .mobile-nav-item {
            font-size: 15px;
            font-weight: 500;
        }
        .mobile-nav-item-active {
            font-size: 15px;
            font-weight: 600;
        }
       
        /* Enhanced responsive dropdowns */
        .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            min-width: 12rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border-radius: 0.5rem;
            padding: 0.5rem 0;
            z-index: 100;
        }
        
        @media (min-width: 768px) {
            .dropdown:hover .dropdown-content {
                display: block;
            }
        }
        
        .dropdown-content.active {
            display: block;
        }
        
        /* Mobile menu enhancements */
        .mobile-menu {
            display: none;
        }
        
        .mobile-menu.active {
            display: block;
        }
        
        .mobile-dropdown-content {
            display: none;
            padding-left: 1rem;
        }
        
        .mobile-dropdown-content.active {
            display: block;
        }
        
        /* Smooth animations */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease;
        }
        
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Hero background with professional image */
        .hero-background {
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1542838132-92c53300491e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        
        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* Distribution point animations */
        .distribution-point {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(239, 68, 68, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
            }
        }
        
        /* Professional button animations */
        .btn-professional {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .btn-professional::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn-professional:hover::before {
            left: 100%;
        }
        
        /* Scroll progress bar */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(90deg, #3B82F6, #10B981);
            z-index: 1002;
            transition: width 0.3s ease;
        }

        /* Responsive improvements */
        @media (max-width: 1280px) {
            .desktop-nav {
                display: none !important;
            }
            .mobile-menu-btn {
                display: block !important;
            }
        }

        @media (min-width: 1024px) and (max-width: 1280px) {
            .lg-md\:flex {
                display: flex !important;
            }
            .lg-md\:hidden {
                display: none !important;
            }
            .desktop-nav {
                display: flex !important;
            }
            .mobile-menu-btn {
                display: none !important;
            }
        }

        @media (max-width: 768px) {
            .hero-background {
                background-attachment: scroll;
            }
            .hero-title {
                font-size: 2.5rem !important;
                line-height: 1.2 !important;
            }
            .hero-subtitle {
                font-size: 1.25rem !important;
            }
            .section-title {
                font-size: 2rem !important;
            }
            .section-subtitle {
                font-size: 1.125rem !important;
            }
            .program-card {
                margin-bottom: 1.5rem;
            }
            .stats-grid {
                grid-template-columns: 1fr !important;
                gap: 1rem !important;
            }
            .footer-grid {
                grid-template-columns: 1fr !important;
                gap: 2rem !important;
            }
            .modal-content {
                padding: 1.5rem;
                margin: 1rem;
            }
            .btn-responsive {
                width: 100%;
                margin-bottom: 0.5rem;
            }
        }

        @media (max-width: 475px) {
            .hero-title {
                font-size: 2rem !important;
            }
            .hero-subtitle {
                font-size: 1.125rem !important;
            }
            .section-title {
                font-size: 1.75rem !important;
            }
            .logo-main {
                font-size: 18px;
            }
            .logo-sub {
                font-size: 10px;
            }
            .btn-text {
                font-size: 0.875rem;
            }
            .counter {
                font-size: 2rem !important;
            }
            .grid-responsive {
                grid-template-columns: 1fr !important;
            }
        }

        /* Touch-friendly improvements */
        @media (hover: none) {
            .hover-lift:hover {
                transform: none;
            }
            .nav-item:hover::after {
                width: 0;
            }
            .btn-professional:hover::before {
                left: -100%;
            }
        }

        /* AUTHENTICATION STYLES */
        .user-menu {
            display: none;
            position: absolute;
            top: 60px;
            right: 0;
            background: white;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-radius: 10px;
            min-width: 250px;
            z-index: 1000;
        }
        .user-menu.show {
            display: block;
        }
        .profile-section {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
        }
        .profile-pic {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #3b82f6;
        }
        .menu-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .menu-item:hover {
            background: #f3f4f6;
            padding-left: 1.25rem;
        }
        .auth-form-input {
            transition: all 0.3s ease;
            border: 2px solid #e5e7eb;
        }
        .auth-form-input:focus {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(59, 130, 246, 0.3);
            border-color: #3b82f6;
        }
        .auth-btn-primary {
            background: linear-gradient(135deg, #3B82F6, #2563EB);
            color: white;
        }

        /* Photo upload styles */
        .upload-dropzone {
            transition: all 0.3s ease;
        }
        .upload-dropzone.drag-over {
            border-color: #3b82f6 !important;
            background-color: rgba(59, 130, 246, 0.05);
        }

        /* Home icon button */
        .home-icon-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3B82F6, #2563EB);
            color: white;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        .home-icon-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        /* Photo modal sections */
        .photo-section {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .photo-section.hidden {
            opacity: 0;
            transform: translateX(-20px);
            pointer-events: none;
            position: absolute;
            width: 0;
            height: 0;
            overflow: hidden;
        }
        .photo-section:not(.hidden) {
            opacity: 1;
            transform: translateX(0);
            position: relative;
            width: auto;
            height: auto;
            overflow: visible;
        }

        /* Crop overlay styles */
        #crop-overlay {
            pointer-events: none;
        }
        #crop-image {
            transition: transform 0.3s ease;
            max-width: 100%;
            max-height: 100%;
            display: block;
        }
        #photo-back-btn {
            transition: all 0.3s ease;
        }
        #photo-back-btn:hover {
            transform: translateX(-3px);
        }
    </style>
</head>
<body class="font-sans">
    <!-- Scroll Progress Bar -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Enhanced Responsive Navigation -->
    <nav class="nav-professional shadow-lg fixed w-full z-50 transition-all duration-300" id="mainNav">
        <div class="max-w-full mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <!-- Logo Section -->
                <div class="flex items-center flex-shrink-0">
                    <div class="flex items-center">
                        <div class="bg-gradient-to-r from-primary-blue to-primary-green p-2 rounded-lg mr-3">
                            <i class="fas fa-hands-helping text-white text-xl"></i>
                        </div>
                        <div>
                            <div class="logo-main text-gray-800">HopeLink</div>
                            <div class="logo-sub text-primary-green">Mahama Refugee Camp</div>
                        </div>
                    </div>
                </div>
               
                <!-- Desktop Navigation - All in one line with consistent spacing -->
                <div class="desktop-nav hidden lg-md:flex items-center flex-1 justify-center">
                    <div class="flex items-center space-x-3 lg-md:space-x-4 xl:space-x-5">
                        <a href="index.html" class="nav-item text-gray-600 hover:text-primary-blue transition duration-300">Home</a>
                       
                        <!-- Programs Dropdown -->
                        <div class="dropdown relative">
                            <button class="nav-item dropdown-btn text-gray-600 hover:text-primary-blue transition duration-300 flex items-center" data-dropdown="programs">
                                Programs <i class="fas fa-chevron-down ml-1 text-xs"></i>
                            </button>
                            <div class="dropdown-content" id="programs-dropdown">
                                <a href="hunger-help.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-primary-blue transition">Hunger Help</a>
                                <a href="./Youth Empowerment .html" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-primary-blue transition">Youth Empowerment</a>
                                <a href="mental-wellness.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-primary-blue transition">Mental Wellness</a>
                            </div>
                        </div>
                       
                        <a href="about-us.html" class="nav-item text-gray-600 hover:text-primary-blue transition duration-300">who we are</a>
                        <a href="get-involved.html" class="nav-item text-gray-600 hover:text-primary-blue transition duration-300">Get Involved</a>
                       
                        <!-- News & Updates -->
                        <div class="dropdown relative">
                            <button class="nav-item dropdown-btn text-gray-600 hover:text-primary-blue transition duration-300 flex items-center" data-dropdown="news">
                                News & Updates <i class="fas fa-chevron-down ml-1 text-xs"></i>
                            </button>
                            <div class="dropdown-content" id="news-dropdown">
                                <a href="news.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-primary-blue transition">Latest News</a>
                                <a href="./advertisement.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-primary-blue transition">advertisement</a>
                                <a href="stories.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-primary-blue transition">Success Stories</a>
                            </div>
                        </div>
                       
                        <a href="contact.html" class="nav-item text-primary-blue font-semibold border-b-2 border-primary-blue">Contact</a>
                       
                        <!-- Opportunities -->
                        <div class="dropdown relative">
                            <button class="nav-item dropdown-btn opportunities-btn px-3 py-2 lg-md:px-4 lg-md:py-2 rounded-lg transition duration-300 flex items-center" data-dropdown="opportunities">
                                Opportunities <i class="fas fa-chevron-down ml-1 text-xs"></i>
                            </button>
                            <div class="dropdown-content" id="opportunities-dropdown">
                                <a href="volunteer.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-primary-blue transition">Volunteer</a>
                                <a href="careers.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-primary-blue transition">Careers</a>
                                <a href="partnerships.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-primary-blue transition">Partnerships</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Section with Donate, Login/Signup OR User Profile -->
                <div id="nav-right-section" class="desktop-nav hidden lg-md:flex items-center space-x-2 lg-md:space-x-3 flex-shrink-0">
                    <!-- Donate Button -->
                    <button onclick="openModal('donateModal')" class="donate-btn btn-professional bg-primary-green text-white px-4 py-2 lg-md:px-5 lg-md:py-2 rounded-lg transition transform hover:scale-105 shadow-lg">
                        <i class="fas fa-heart mr-2"></i>Donate
                    </button>

                    <!-- Login/Signup Buttons (Visible when not logged in) -->
                    <div id="auth-buttons-section" class="flex space-x-2 lg-md:space-x-3">
                        <button onclick="window.location.href='auth.html?view=login'" class="login-btn px-3 py-2 lg-md:px-4 lg-md:py-2 rounded-lg transition flex items-center">
                            <i class="fas fa-sign-in-alt mr-2"></i>Login
                        </button>
                        <button onclick="window.location.href='auth.html?view=signup'" class="signup-btn px-3 py-2 lg-md:px-4 lg-md:py-2 rounded-lg transition flex items-center">
                            <i class="fas fa-user-plus mr-2"></i>Sign Up
                        </button>
                    </div>

                    <!-- User Profile Section (Visible when logged in) -->
                    <div id="user-profile-section" class="hidden relative">
                        <button id="user-menu-btn" class="flex items-center space-x-3 bg-gray-50 hover:bg-gray-100 rounded-xl p-2 transition-all duration-300">
                            <img id="user-avatar" src="https://ui-avatars.com/api/?name=Guest&background=random" 
                                 class="w-8 h-8 rounded-full border-2 border-blue-500">
                            <div class="text-left">
                                <div id="user-name" class="font-semibold text-gray-800">Guest</div>
                                <div id="user-role" class="text-xs text-gray-500">Not logged in</div>
                            </div>
                            <i class="fas fa-chevron-down text-gray-400"></i>
                        </button>
                        
                        <!-- User Dropdown Menu -->
                        <div id="user-dropdown" class="user-menu">
                            <div class="profile-section">
                                <div class="flex items-center space-x-3">
                                    <img id="dropdown-avatar" style="border-radius: 50%;" src="https://ui-avatars.com/api/?name=Guest&background=random" 
                                         class="profile-pic">
                                    <div>
                                        <div id="dropdown-name" class="font-bold text-gray-800">Guest User</div>
                                        <div id="dropdown-email" class="text-sm text-gray-500">guest@example.com</div>
                                        <div id="dropdown-role" class="text-xs text-blue-600 font-semibold">Guest</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="py-2">
                                <div class="menu-item" onclick="goToDashboard()">
                                    <i class="fas fa-tachometer-alt text-blue-500 mr-3"></i>
                                    Dashboard
                                </div>
                                <div class="menu-item" onclick="openProfileModal()">
                                    <i class="fas fa-user-circle text-green-500 mr-3"></i>
                                    My Profile
                                </div>
                                <div class="menu-item" onclick="openPhotoModal()">
                                    <i class="fas fa-camera text-pink-500 mr-3"></i>
                                    Change Photo
                                </div>
                                <div class="menu-item" onclick="openPasswordModal()">
                                    <i class="fas fa-key text-yellow-500 mr-3"></i>
                                    Change Password
                                </div>
                                <div class="border-t border-gray-200 mt-2 pt-2">
                                    <div class="menu-item text-red-600" onclick="logout()">
                                        <i class="fas fa-sign-out-alt mr-3"></i>
                                        Logout
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mobile and Tablet Menu Button -->
                <button id="mobileMenuButton" class="mobile-menu-btn lg-md:hidden text-gray-600 hover:text-primary-blue transition flex-shrink-0">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
           
            <!-- Mobile and Tablet Menu -->
            <div id="mobileMenu" class="mobile-menu lg-md:hidden">
                <div class="px-4 py-2 space-y-3">
                    <a href="index.html" class="block mobile-nav-item-active py-2 text-primary-blue font-semibold border-b border-gray-200 transition">Home</a>
                   
                    <!-- Programs Mobile Dropdown -->
                    <div class="mobile-dropdown">
                        <button class="mobile-dropdown-btn w-full text-left py-2 mobile-nav-item text-gray-600 hover:text-primary-blue transition flex items-center justify-between">
                            Programs <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div class="mobile-dropdown-content">
                            <a href="hunger-help.html" class="block py-2 text-gray-600 hover:text-primary-blue transition pl-4">Hunger Help</a>
                            <a href="./Youth Empowerment .html" class="block py-2 text-gray-600 hover:text-primary-blue transition pl-4">Youth Empowerment</a>
                            <a href="mental-wellness.html" class="block py-2 text-gray-600 hover:text-primary-blue transition pl-4">Mental Wellness</a>
                        </div>
                    </div>
                   
                    <a href="about-us.html" class="block py-2 mobile-nav-item text-gray-600 hover:text-primary-blue transition">About</a>
                    <a href="get-involved.html" class="block py-2 mobile-nav-item text-gray-600 hover:text-primary-blue transition">Get Involved</a>
                   
                    <!-- News & Updates Mobile Dropdown -->
                    <div class="mobile-dropdown">
                        <button class="mobile-dropdown-btn w-full text-left py-2 mobile-nav-item text-gray-600 hover:text-primary-blue transition flex items-center justify-between">
                            News & Updates <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div class="mobile-dropdown-content">
                            <a href="news.html" class="block py-2 text-gray-600 hover:text-primary-blue transition pl-4">Latest News</a>
                            <a href="./advertisement.html" class="block py-2 text-gray-600 hover:text-primary-blue transition pl-4">advertisement</a>
                            <a href="stories.html" class="block py-2 text-gray-600 hover:text-primary-blue transition pl-4">Success Stories</a>
                        </div>
                    </div>
                   
                    <a href="contact.html" class="block py-2 mobile-nav-item-active text-primary-blue font-semibold border-b-2 border-primary-blue transition">Contact</a>
                   
                    <!-- Opportunities Mobile Dropdown -->
                    <div class="mobile-dropdown">
                        <button class="mobile-dropdown-btn w-full text-left py-2 opportunities-btn rounded-lg transition flex items-center justify-between px-4">
                            Opportunities <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div class="mobile-dropdown-content">
                            <a href="volunteer.html" class="block py-2 text-gray-600 hover:text-primary-blue transition pl-4">Volunteer</a>
                            <a href="careers.html" class="block py-2 text-gray-600 hover:text-primary-blue transition pl-4">Careers</a>
                            <a href="partnerships.html" class="block py-2 text-gray-600 hover:text-primary-blue transition pl-4">Partnerships</a>
                        </div>
                    </div>
                   
                    <!-- Mobile Donate Button -->
                    <button onclick="openModal('donateModal')" class="w-full donate-btn btn-professional bg-primary-green text-white px-6 py-2 rounded-lg transition transform hover:scale-105 text-left flex items-center mt-2">
                        <i class="fas fa-heart mr-2"></i>Donate Now
                    </button>

                    <!-- Mobile Login/Signup/Profile Section -->
                    <div id="mobile-auth-section" class="flex flex-col space-y-2 pt-2">
                        <!-- Mobile User Profile (visible when logged in) -->
                        <div id="mobile-user-profile" class="hidden">
                            <div class="flex items-center space-x-3 bg-gray-50 p-3 rounded-lg">
                                <img id="mobile-user-avatar" src="https://ui-avatars.com/api/?name=Guest&background=random" 
                                     class="w-10 h-10 rounded-full border-2 border-blue-500">
                                <div class="flex-1">
                                    <div id="mobile-user-name" class="font-semibold text-gray-800">Guest</div>
                                    <div id="mobile-user-role" class="text-xs text-gray-500">Not logged in</div>
                                </div>
                            </div>
                            <div class="mt-2 space-y-1">
                                <button onclick="openProfileModal()" class="w-full text-left py-2 px-3 text-gray-600 hover:bg-blue-50 rounded">
                                    <i class="fas fa-user-circle mr-2 text-green-500"></i>My Profile
                                </button>
                                <button onclick="openPhotoModal()" class="w-full text-left py-2 px-3 text-gray-600 hover:bg-blue-50 rounded">
                                    <i class="fas fa-camera mr-2 text-pink-500"></i>Change Photo
                                </button>
                                <button onclick="logout()" class="w-full text-left py-2 px-3 text-red-600 hover:bg-red-50 rounded">
                                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                                </button>
                            </div>
                        </div>
                        
                        <!-- Mobile Login/Signup buttons (visible when not logged in) -->
                        <div id="mobile-auth-buttons" class="flex flex-col space-y-2">
                            <button onclick="window.location.href='auth.html?view=login'" class="login-btn px-4 py-2 rounded-lg transition flex items-center justify-center">
                                <i class="fas fa-sign-in-alt mr-2"></i>Login
                            </button>
                            <button onclick="window.location.href='auth.html?view=signup'" class="signup-btn px-4 py-2 rounded-lg transition flex items-center justify-center">
                                <i class="fas fa-user-plus mr-2"></i>Sign Up
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="pt-32 hero-background min-h-screen flex items-center relative overflow-hidden">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 text-center text-white relative z-10">
            <div class="fade-in">
                <h1 class="hero-title text-4xl sm:text-5xl lg:text-6xl font-bold mb-6 leading-tight">
                    Hunger Help Program
                </h1>
                <p class="hero-subtitle text-lg sm:text-xl lg:text-2xl mb-8 opacity-90 max-w-4xl mx-auto leading-relaxed">
                    Providing essential food assistance and nutrition support to families in Mahama Camp through innovative technology and community partnerships. Our mission is to ensure no one goes hungry while building sustainable food security solutions.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="openModal('foodRequestModal')" class="btn-professional bg-white text-primary-green px-6 sm:px-8 py-4 rounded-lg font-semibold text-base sm:text-lg hover:bg-gray-100 transition transform hover:scale-105 shadow-lg">
                        <i class="fas fa-utensils mr-2"></i>Request Food Assistance
                    </button>
                    <button onclick="openModal('donateModal')" class="btn-professional bg-primary-yellow text-gray-800 px-6 sm:px-8 py-4 rounded-lg font-semibold text-base sm:text-lg hover:bg-yellow-400 transition transform hover:scale-105 shadow-lg">
                        <i class="fas fa-gift mr-2"></i>Donate Food Resources
                    </button>
                </div>
                
                <!-- Quick Stats -->
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 sm:gap-8 mt-16 max-w-2xl mx-auto">
                    <div class="text-center bg-white bg-opacity-10 rounded-xl p-6 backdrop-blur-sm">
                        <div class="text-2xl sm:text-3xl font-bold counter" data-target="2547">0</div>
                        <div class="text-sm opacity-80 mt-2">Families Helped This Month</div>
                    </div>
                    <div class="text-center bg-white bg-opacity-10 rounded-xl p-6 backdrop-blur-sm">
                        <div class="text-2xl sm:text-3xl font-bold counter" data-target="18923">0</div>
                        <div class="text-sm opacity-80 mt-2">Meals Provided</div>
                    </div>
                    <div class="text-center bg-white bg-opacity-10 rounded-xl p-6 backdrop-blur-sm">
                        <div class="text-2xl sm:text-3xl font-bold counter" data-target="12">0</div>
                        <div class="text-sm opacity-80 mt-2">Distribution Points</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Food Request Section -->
    <section id="food-request" class="py-16 sm:py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12 sm:mb-16 fade-in">
                <h2 class="text-3xl sm:text-4xl font-bold text-gray-800 mb-4">Request Food Assistance</h2>
                <p class="text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto">Get immediate help through our digital food request system designed for accessibility and efficiency</p>
            </div>
            
            <div class="grid lg:grid-cols-2 gap-8 sm:gap-12">
                <!-- Request Form -->
                <div class="fade-in">
                    <div class="bg-gray-50 p-6 sm:p-8 rounded-2xl shadow-lg hover-lift">
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">Emergency Food Request</h3>
                        <form id="foodRequestForm" class="space-y-6">
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-gray-700 mb-2 font-medium">Family Size</label>
                                    <input type="number" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue" required min="1" max="20">
                                </div>
                                <div>
                                    <label class="block text-gray-700 mb-2 font-medium">Urgency Level</label>
                                    <select class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue" required>
                                        <option value="">Select urgency</option>
                                        <option value="low">Low - Need within a week</option>
                                        <option value="medium">Medium - Need within 3 days</option>
                                        <option value="high">High - Need immediately</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2 font-medium">Special Dietary Needs</label>
                                <textarea class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue" rows="3" placeholder="Any allergies, medical conditions, or special requirements"></textarea>
                            </div>
                            
                            <div>
                                <label class="block text-gray-700 mb-2 font-medium">Your Location in Camp</label>
                                <input type="text" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue" required placeholder="Sector and block number">
                            </div>
                            
                            <button type="submit" class="w-full bg-primary-green text-white py-4 rounded-lg font-semibold hover:bg-green-600 transition flex items-center justify-center text-lg">
                                <i class="fas fa-paper-plane mr-3"></i>Submit Request
                            </button>
                        </form>
                    </div>
                </div>
                
                <!-- How It Works -->
                <div class="fade-in">
                    <div class="bg-primary-light p-6 sm:p-8 rounded-2xl shadow-lg h-full">
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">How It Works</h3>
                        
                        <div class="space-y-6">
                            <div class="flex items-start">
                                <div class="w-10 h-10 bg-primary-blue rounded-full flex items-center justify-center text-white mr-4 flex-shrink-0">
                                    <span class="font-bold">1</span>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-1 text-lg">Submit Request</h4>
                                    <p class="text-gray-600">Fill out our simple form with your family details and specific needs. Our system is designed to be accessible and user-friendly.</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="w-10 h-10 bg-primary-green rounded-full flex items-center justify-center text-white mr-4 flex-shrink-0">
                                    <span class="font-bold">2</span>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-1 text-lg">Quick Review</h4>
                                    <p class="text-gray-600">Our dedicated team reviews your request within 24 hours, prioritizing based on urgency and family circumstances.</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="w-10 h-10 bg-primary-yellow rounded-full flex items-center justify-center text-white mr-4 flex-shrink-0">
                                    <span class="font-bold">3</span>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800 mb-1 text-lg">Receive Assistance</h4>
                                    <p class="text-gray-600">Get notified about food collection or delivery through SMS or our mobile app, with clear instructions and timing.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-8 p-4 bg-white rounded-lg border border-primary-green">
                            <h4 class="font-semibold text-primary-green mb-2 flex items-center text-lg">
                                <i class="fas fa-info-circle mr-2"></i>Important Information
                            </h4>
                            <ul class="text-gray-600 space-y-2">
                                <li class="flex items-start">
                                    <i class="fas fa-check text-primary-green mt-1 mr-2"></i>
                                    <span>All requests are confidential and secure</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check text-primary-green mt-1 mr-2"></i>
                                    <span>Priority given to families with children and elderly</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check text-primary-green mt-1 mr-2"></i>
                                    <span>Emergency requests processed within 6 hours</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Food Distribution Section -->
    <section id="distribution" class="py-16 sm:py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12 sm:mb-16 fade-in">
                <h2 class="text-3xl sm:text-4xl font-bold text-gray-800 mb-4">Food Distribution Network</h2>
                <p class="text-lg sm:text-xl text-gray-600">Find food distribution points and schedules across Mahama Camp</p>
            </div>
            
            <div class="grid lg:grid-cols-2 gap-8 sm:gap-12 mb-12 sm:mb-16">
                <!-- Distribution Map -->
                <div class="fade-in">
                    <div class="bg-white p-6 rounded-2xl shadow-lg">
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">Camp Distribution Map</h3>
                        <div class="food-distribution-map h-64 sm:h-80 bg-gradient-to-br from-blue-50 to-green-50 rounded-lg relative overflow-hidden border-2 border-gray-200">
                            <!-- Distribution points -->
                            <div class="distribution-point absolute cursor-pointer" style="top: 30%; left: 20%;" data-name="Sector A Center" data-schedule="Mon, Wed, Fri 9AM-12PM"></div>
                            <div class="distribution-point absolute cursor-pointer" style="top: 60%; left: 40%;" data-name="Sector B Hub" data-schedule="Tue, Thu, Sat 9AM-12PM"></div>
                            <div class="distribution-point absolute cursor-pointer" style="top: 45%; left: 70%;" data-name="Sector C Point" data-schedule="Mon, Wed, Fri 2PM-5PM"></div>
                            <div class="distribution-point absolute cursor-pointer" style="top: 75%; left: 55%;" data-name="Central Area" data-schedule="Daily 10AM-1PM"></div>
                        </div>
                        <p class="text-gray-600 mt-4 text-sm">Click on distribution points to see details</p>
                    </div>
                </div>
                
                <!-- Distribution Schedule -->
                <div class="fade-in">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">Distribution Schedule</h3>
                    
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-primary-blue text-white">
                                    <tr>
                                        <th class="py-3 px-4 text-left">Day</th>
                                        <th class="py-3 px-4 text-left">Location</th>
                                        <th class="py-3 px-4 text-left">Time</th>
                                        <th class="py-3 px-4 text-left">Status</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-200">
                                    <tr class="hover:bg-gray-50 transition">
                                        <td class="py-3 px-4 font-medium">Monday</td>
                                        <td class="py-3 px-4">Sector A Distribution Center</td>
                                        <td class="py-3 px-4">9:00 AM - 12:00 PM</td>
                                        <td class="py-3 px-4">
                                            <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-xs font-semibold">Active</span>
                                        </td>
                                    </tr>
                                    <tr class="hover:bg-gray-50 transition">
                                        <td class="py-3 px-4 font-medium">Tuesday</td>
                                        <td class="py-3 px-4">Sector D Assistance Center</td>
                                        <td class="py-3 px-4">9:00 AM - 12:00 PM</td>
                                        <td class="py-3 px-4">
                                            <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-xs font-semibold">Active</span>
                                        </td>
                                    </tr>
                                    <tr class="hover:bg-gray-50 transition">
                                        <td class="py-3 px-4 font-medium">Wednesday</td>
                                        <td class="py-3 px-4">Sector B Distribution Point</td>
                                        <td class="py-3 px-4">9:00 AM - 12:00 PM</td>
                                        <td class="py-3 px-4">
                                            <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-xs font-semibold">Active</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex flex-col sm:flex-row gap-4">
                        <button onclick="downloadSchedule()" class="flex-1 bg-primary-blue text-white py-3 rounded-lg font-semibold hover:bg-blue-600 transition flex items-center justify-center">
                            <i class="fas fa-download mr-2"></i>Download Schedule
                        </button>
                        <button onclick="openModal('distributionModal')" class="flex-1 bg-white border border-primary-blue text-primary-blue py-3 rounded-lg font-semibold hover:bg-blue-50 transition flex items-center justify-center">
                            <i class="fas fa-info-circle mr-2"></i>More Info
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                <!-- Footer content would continue here -->
                <div>
                    <div class="flex items-center mb-4">
                        <div class="bg-gradient-to-r from-primary-blue to-primary-green p-2 rounded-lg mr-3">
                            <i class="fas fa-hands-helping text-white"></i>
                        </div>
                        <div>
                            <div class="font-bold text-lg">HopeLink</div>
                            <div class="text-xs text-primary-green font-semibold">Mahama Refugee Camp</div>
                        </div>
                    </div>
                    <p class="text-gray-400 text-sm">
                        Empowering refugees through technology and innovation in Mahama Camp, Rwanda.
                    </p>
                </div>
                
                <!-- Additional footer columns -->
            </div>
            
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2025 HopeLink Mahama â€” Empowering Refugees Through Innovation.</p>
                <p class="text-xs mt-2">All rights reserved. Registered non-profit organization.</p>
            </div>
        </div>
    </footer>

    <!-- AUTHENTICATION MODALS -->
    <!-- Profile Modal -->
    <div id="profile-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-gray-800">My Profile</h3>
                    <button onclick="closeProfileModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                
                <div class="space-y-6">
                    <div class="flex flex-col items-center space-y-4">
                        <img id="modal-avatar" src="https://ui-avatars.com/api/?name=Guest&background=random" 
                             class="w-32 h-32 rounded-full border-4 border-blue-500 object-cover">
                        <div class="text-center">
                            <h4 id="modal-fullname" class="text-xl font-bold text-gray-800">Guest User</h4>
                            <p id="modal-email" class="text-gray-600">guest@example.com</p>
                            <span id="modal-role" class="inline-block mt-2 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold">
                                Guest
                            </span>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">First Name</label>
                            <input type="text" id="profile-firstname" 
                                   class="auth-form-input w-full p-3 rounded-lg" placeholder="First Name">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Last Name</label>
                            <input type="text" id="profile-lastname" 
                                   class="auth-form-input w-full p-3 rounded-lg" placeholder="Last Name">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Phone Number</label>
                            <input type="tel" id="profile-phone" 
                                   class="auth-form-input w-full p-3 rounded-lg" placeholder="Phone Number">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">Address</label>
                            <input type="text" id="profile-address" 
                                   class="auth-form-input w-full p-3 rounded-lg" placeholder="Address">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Bio</label>
                        <textarea id="profile-bio" rows="4" 
                                  class="auth-form-input w-full p-3 rounded-lg" placeholder="Tell us about yourself..."></textarea>
                    </div>
                    
                    <div class="flex justify-end space-x-4 pt-4">
                        <button onclick="closeProfileModal()" class="px-6 py-3 text-gray-600 hover:text-gray-800 font-medium">
                            Cancel
                        </button>
                        <button onclick="updateProfile()" class="auth-btn-primary px-6 py-3 rounded-lg font-semibold">
                            Save Changes
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Change Photo Modal with Back Navigation -->
    <div id="photo-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl w-full max-w-md">
            <div class="p-6">
                <!-- Updated header with back button -->
                <div class="flex items-center mb-6">
                    <!-- Back Button -->
                    <button id="photo-back-btn" class="mr-4 text-gray-500 hover:text-gray-700 transition-colors">
                        <i class="fas fa-arrow-left text-xl"></i>
                    </button>
                    <h3 class="text-2xl font-bold text-gray-800 flex-1">Change Profile Photo</h3>
                    <button onclick="closePhotoModal()" class="text-gray-500 hover:text-gray-700 ml-4">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                
                <div class="space-y-6">
                    <!-- Current Photo Section (Upload) -->
                    <div id="current-photo-section" class="photo-section transition-all duration-300">
                        <div class="flex justify-center">
                            <div class="relative">
                                <img id="current-photo" src="https://ui-avatars.com/api/?name=Guest&background=random" 
                                     class="w-32 h-32 rounded-full border-4 border-blue-500 object-cover">
                                <div class="absolute bottom-0 right-0 bg-blue-500 text-white p-2 rounded-full">
                                    <i class="fas fa-camera"></i>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Photo Actions -->
                        <div class="mt-6 space-y-3">
                            <div>
                                <label class="block text-gray-700 font-medium mb-3">Upload New Photo</label>
                                <div class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-blue-500 transition-colors upload-dropzone"
                                     id="upload-dropzone">
                                    <i class="fas fa-cloud-upload-alt text-gray-400 text-3xl mb-3"></i>
                                    <p class="text-gray-600 mb-2" id="upload-text">Drag & drop your photo here</p>
                                    <p class="text-sm text-gray-500 mb-4">or</p>
                                    <input type="file" id="photo-upload" accept="image/*" class="hidden">
                                    <label for="photo-upload" class="auth-btn-primary px-6 py-2 rounded-lg font-semibold cursor-pointer inline-block">
                                        Browse Files
                                    </label>
                                    <p class="text-xs text-gray-500 mt-3">JPG, PNG or GIF (Max 5MB)</p>
                                </div>
                                <div id="upload-progress" class="hidden mt-3">
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div id="progress-bar" class="bg-green-500 h-2 rounded-full" style="width: 0%"></div>
                                    </div>
                                    <p id="progress-text" class="text-xs text-gray-600 mt-1">Uploading...</p>
                                </div>
                            </div>
                            
                            <div class="pt-4">
                                <h4 class="text-sm font-medium text-gray-700 mb-3">Or choose a default avatar</h4>
                                <div class="grid grid-cols-4 gap-3 mb-4">
                                    <div class="aspect-square rounded-full bg-gradient-to-r from-blue-400 to-purple-500 cursor-pointer hover:scale-110 transition" 
                                         onclick="selectAvatar('blue')" title="Blue Avatar"></div>
                                    <div class="aspect-square rounded-full bg-gradient-to-r from-green-400 to-teal-500 cursor-pointer hover:scale-110 transition" 
                                         onclick="selectAvatar('green')" title="Green Avatar"></div>
                                    <div class="aspect-square rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 cursor-pointer hover:scale-110 transition" 
                                         onclick="selectAvatar('yellow')" title="Yellow Avatar"></div>
                                    <div class="aspect-square rounded-full bg-gradient-to-r from-pink-400 to-red-500 cursor-pointer hover:scale-110 transition" 
                                         onclick="selectAvatar('pink')" title="Pink Avatar"></div>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 pt-4">
                                <button onclick="closePhotoModal()" class="px-6 py-2 text-gray-600 hover:text-gray-800 font-medium">
                                    Cancel
                                </button>
                                <button id="upload-next-btn" onclick="handleUploadNext()" class="auth-btn-primary px-6 py-2 rounded-lg font-semibold">
                                    Next
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Crop Section (Hidden by default) -->
                    <div id="crop-section" class="photo-section hidden transition-all duration-300">
                        <div class="mb-4">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Crop Your Photo</h4>
                            <p class="text-sm text-gray-600">Adjust the cropping area to get the perfect profile picture</p>
                        </div>
                        
                        <!-- Crop Area -->
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 mb-4">
                            <div id="crop-container" class="w-full h-64 bg-gray-100 rounded flex items-center justify-center">
                                <div id="crop-preview" class="relative overflow-hidden rounded-lg">
                                    <img id="crop-image" src="" alt="Crop preview" class="max-w-full max-h-56">
                                    <div id="crop-overlay" class="absolute inset-0 border-2 border-white border-dashed"></div>
                                </div>
                            </div>
                            
                            <!-- Crop Controls -->
                            <div class="mt-4 space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Zoom</label>
                                    <input type="range" id="crop-zoom" min="1" max="3" step="0.1" value="1" 
                                           class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                                </div>
                                
                                <div class="grid grid-cols-3 gap-2">
                                    <button onclick="cropRotate(-90)" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition">
                                        <i class="fas fa-undo"></i>
                                    </button>
                                    <button onclick="cropRotate(90)" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition">
                                        <i class="fas fa-redo"></i>
                                    </button>
                                    <button onclick="resetCrop()" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex justify-between space-x-4 pt-4">
                            <button onclick="backToUpload()" class="px-6 py-2 text-gray-600 hover:text-gray-800 font-medium flex items-center">
                                <i class="fas fa-arrow-left mr-2"></i> Back
                            </button>
                            <div class="space-x-3">
                                <button onclick="cancelCrop()" class="px-6 py-2 text-gray-600 hover:text-gray-800 font-medium">
                                    Cancel
                                </button>
                                <button onclick="applyCrop()" class="auth-btn-primary px-6 py-2 rounded-lg font-semibold">
                                    Apply Crop
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Preview Section (Hidden by default) -->
                    <div id="preview-section" class="photo-section hidden transition-all duration-300">
                        <div class="text-center mb-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-2">Preview Your New Photo</h4>
                            <p class="text-sm text-gray-600">This is how your profile will look to others</p>
                        </div>
                        
                        <div class="flex flex-col items-center space-y-6">
                            <!-- Large Preview -->
                            <div class="relative">
                                <img id="final-preview" src="" alt="Final preview" 
                                     class="w-40 h-40 rounded-full border-4 border-blue-500 object-cover">
                                <div class="absolute -bottom-2 -right-2 bg-green-500 text-white p-2 rounded-full">
                                    <i class="fas fa-check"></i>
                                </div>
                            </div>
                            
                            <!-- Profile Card Preview -->
                            <div class="bg-gray-50 rounded-xl p-6 w-full max-w-sm">
                                <div class="flex items-center space-x-4">
                                    <img id="preview-avatar" src="" alt="Preview avatar" 
                                         class="w-16 h-16 rounded-full border-2 border-blue-500 object-cover">
                                    <div>
                                        <h5 class="font-bold text-gray-800" id="preview-name">Guest User</h5>
                                        <p class="text-sm text-gray-600" id="preview-email">guest@example.com</p>
                                        <span class="inline-block mt-1 px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-semibold">
                                            Member
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex justify-center space-x-4 pt-6 w-full">
                                <button onclick="backToCrop()" class="px-6 py-2 text-gray-600 hover:text-gray-800 font-medium">
                                    Edit Again
                                </button>
                                <button onclick="saveFinalPhoto()" class="auth-btn-primary px-6 py-2 rounded-lg font-semibold">
                                    Save Photo
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="password-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl w-full max-w-md">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-gray-800">Change Password</h3>
                    <button onclick="closePasswordModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                
                <form id="change-password-form" class="space-y-6">
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Current Password</label>
                        <input type="password" id="current-password" required
                               class="auth-form-input w-full p-3 rounded-lg" placeholder="Enter current password">
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">New Password</label>
                        <input type="password" id="new-password" required
                               class="auth-form-input w-full p-3 rounded-lg" placeholder="Enter new password">
                        <div class="text-xs text-gray-500 mt-1">Must be at least 6 characters</div>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Confirm New Password</label>
                        <input type="password" id="confirm-new-password" required
                               class="auth-form-input w-full p-3 rounded-lg" placeholder="Confirm new password">
                    </div>
                    
                    <div id="password-error" class="hidden bg-red-50 border border-red-200 text-red-700 p-3 rounded-lg text-sm"></div>
                    <div id="password-success" class="hidden bg-green-50 border border-green-200 text-green-700 p-3 rounded-lg text-sm"></div>
                    
                    <div class="pt-4">
                        <button type="submit" class="w-full auth-btn-primary py-3 rounded-lg font-semibold">
                            Update Password
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Donation Modal -->
    <div id="donateModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4 md:mb-6">
                <h3 class="text-xl md:text-2xl font-bold text-gray-800">Make a Donation</h3>
                <button onclick="closeModal('donateModal')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
           
            <form id="donationForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 mb-2">Donation Amount</label>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-2 mb-2">
                        <button type="button" class="donation-amount py-2 border border-gray-300 rounded hover:bg-primary-blue hover:text-white transition btn-text" data-amount="10">$10</button>
                        <button type="button" class="donation-amount py-2 border border-gray-300 rounded hover:bg-primary-blue hover:text-white transition btn-text" data-amount="25">$25</button>
                        <button type="button" class="donation-amount py-2 border border-gray-300 rounded hover:bg-primary-blue hover:text-white transition btn-text" data-amount="50">$50</button>
                        <button type="button" class="donation-amount py-2 border border-gray-300 rounded hover:bg-primary-blue hover:text-white transition btn-text" data-amount="100">$100</button>
                        <button type="button" class="donation-amount py-2 border border-gray-300 rounded hover:bg-primary-blue hover:text-white transition btn-text" data-amount="250">$250</button>
                        <button type="button" class="donation-amount py-2 border border-gray-300 rounded hover:bg-primary-blue hover:text-white transition btn-text" data-amount="500">$500</button>
                    </div>
                    <input type="number" id="customAmount" placeholder="Custom Amount" class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary-blue">
                </div>
               
                <div>
                    <label class="block text-gray-700 mb-2">Full Name</label>
                    <input type="text" id="donorName" required class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary-blue">
                </div>
               
                <div>
                    <label class="block text-gray-700 mb-2">Email</label>
                    <input type="email" id="donorEmail" required class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary-blue">
                </div>
               
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4">
                    <div>
                        <label class="block text-gray-700 mb-2">Payment Method</label>
                        <select id="paymentMethod" class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary-blue">
                            <option value="credit">Credit Card</option>
                            <option value="paypal">PayPal</option>
                            <option value="bank">Bank Transfer</option>
                            <option value="mobile">Mobile Money</option>
                            <option value="crypto">Cryptocurrency</option>
                        </select>
                    </div>
                   
                    <div id="creditCardFields" class="payment-fields active">
                        <label class="block text-gray-700 mb-2">Card Number</label>
                        <input type="text" placeholder="1234 5678 9012 3456" class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary-blue">
                    </div>
                   
                    <div id="paypalFields" class="payment-fields">
                        <p class="text-sm text-gray-600">You will be redirected to PayPal to complete your donation</p>
                    </div>
                   
                    <div id="bankFields" class="payment-fields">
                        <p class="text-sm text-gray-600">Bank transfer details will be sent to your email</p>
                    </div>
                   
                    <div id="mobileFields" class="payment-fields">
                        <label class="text-gray-700 mb-2">Mobile Number</label>
                        <input type="tel" placeholder="+250 123 456 789" class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary-blue">
                    </div>
                   
                    <div id="cryptoFields" class="payment-fields">
                        <p class="text-sm text-gray-600">Cryptocurrency wallet address: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa</p>
                    </div>
                </div>
               
                <div class="pt-4">
                    <button type="submit" class="w-full donate-btn btn-professional bg-primary-green text-white py-3 rounded-lg font-semibold hover:bg-green-600 transition flex items-center justify-center btn-text">
                        <i class="fas fa-heart mr-2"></i>Donate Now
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Notification System -->
    <div id="notification" class="notification fixed top-20 right-4 z-50 bg-green-500 text-white p-4 rounded-lg shadow-lg hidden">
        <div class="flex items-center">
            <i id="notificationIcon" class="fas fa-check-circle mr-2"></i>
            <span id="notificationMessage">Action completed successfully!</span>
        </div>
    </div>

    <!-- Include the external JavaScript file -->
    <script>
        // ==============================
        // INTEGRATED AUTHENTICATION SYSTEM
        // ==============================

        // Global state
        let currentUser = null;
        let currentPhotoState = 'upload'; // 'upload', 'crop', 'preview'
        let currentUploadedImage = null;

        // Initialize localStorage for demo users (fallback)
        if (!localStorage.getItem('hopelink_users')) {
            localStorage.setItem('hopelink_users', JSON.stringify([]));
        }

        // Get all users from localStorage (demo fallback)
        function getAllLocalUsers() {
            return JSON.parse(localStorage.getItem('hopelink_users') || '[]');
        }

        // Get user by email from localStorage (demo fallback)
        function getLocalUserByEmail(email) {
            const users = getAllLocalUsers();
            return users.find(u => u.email === email);
        }

        // Update user in localStorage (demo fallback)
        function updateLocalUser(userId, updates) {
            const users = getAllLocalUsers();
            const index = users.findIndex(u => u.id === userId);
            if (index !== -1) {
                users[index] = { ...users[index], ...updates };
                localStorage.setItem('hopelink_users', JSON.stringify(users));
                
                // Update current user in session
                if (currentUser && currentUser.id === userId) {
                    currentUser = users[index];
                    sessionStorage.setItem('currentUser', JSON.stringify(currentUser));
                    updateUI();
                }
            }
        }

        // ==============================
        // UNIFIED USER MANAGEMENT
        // ==============================

        // Get user data from localStorage
        function getUserData() {
            // Fallback to localStorage
            if (currentUser && currentUser.id) {
                const localData = getLocalUserByEmail(currentUser.email);
                if (localData) {
                    return { source: 'local', data: localData };
                }
            }
            
            return { source: 'none', data: null };
        }

        // Update user data in localStorage
        function updateUserData(updates) {
            if (!currentUser) return false;
            
            let success = false;
            
            // Update localStorage for fallback
            if (currentUser.id) {
                updateLocalUser(currentUser.id, updates);
                success = true;
                console.log("User data updated in localStorage");
            }
            
            // Update current user in session
            currentUser = { ...currentUser, ...updates };
            sessionStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
            
            return success;
        }

        // Notification system
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const icon = document.getElementById('notificationIcon');
            const messageEl = document.getElementById('notificationMessage');
            
            // Remove existing classes
            notification.className = 'notification fixed top-20 right-4 z-50 p-4 rounded-lg shadow-lg flex items-center';
            
            // Add type-specific classes
            if (type === 'success') {
                notification.classList.add('bg-green-500', 'text-white');
                icon.className = 'fas fa-check-circle mr-2';
            } else if (type === 'error') {
                notification.classList.add('bg-red-500', 'text-white');
                icon.className = 'fas fa-exclamation-circle mr-2';
            } else if (type === 'info') {
                notification.classList.add('bg-blue-500', 'text-white');
                icon.className = 'fas fa-info-circle mr-2';
            }
            
            messageEl.textContent = message;
            notification.classList.remove('hidden');
            
            setTimeout(hideNotification, 5000);
        }

        function hideNotification() {
            const notification = document.getElementById('notification');
            notification.classList.add('hidden');
        }

        // Check login status
        function checkLoginStatus() {
            // Check session storage for existing login
            const userJson = sessionStorage.getItem('currentUser');
            if (userJson) {
                try {
                    currentUser = JSON.parse(userJson);
                    showUserSection();
                    updateUI();
                    return;
                } catch (e) {
                    console.error("Error parsing user data:", e);
                    sessionStorage.removeItem('currentUser');
                }
            }
            
            // No user logged in
            showAuthSection();
        }

        // Update UI based on user state
        function updateUI() {
            if (currentUser) {
                // Get user data
                const userData = getUserData();
                const userInfo = userData.data || currentUser;
                
                // Update desktop navigation
                document.getElementById('user-name').textContent = userInfo.displayName || userInfo.name || userInfo.email;
                document.getElementById('user-role').textContent = userInfo.role === 'admin' ? 'Administrator' : 'Member';
                
                // Generate avatar URL
                let userAvatar;
                if (userInfo.photoURL) {
                    userAvatar = userInfo.photoURL;
                } else if (userInfo.email) {
                    userAvatar = `https://ui-avatars.com/api/?name=${encodeURIComponent(userInfo.displayName || userInfo.name || userInfo.email)}&background=random`;
                } else {
                    userAvatar = 'https://ui-avatars.com/api/?name=Guest&background=random';
                }
                
                document.getElementById('user-avatar').src = userAvatar;
                
                // Update dropdown
                document.getElementById('dropdown-name').textContent = userInfo.displayName || userInfo.name || userInfo.email;
                document.getElementById('dropdown-email').textContent = userInfo.email || 'No email';
                document.getElementById('dropdown-role').textContent = userInfo.role === 'admin' ? 'Administrator' : 'Member';
                document.getElementById('dropdown-avatar').src = userAvatar;
                
                // Update mobile navigation
                document.getElementById('mobile-user-name').textContent = userInfo.displayName || userInfo.name || userInfo.email;
                document.getElementById('mobile-user-role').textContent = userInfo.role === 'admin' ? 'Administrator' : 'Member';
                document.getElementById('mobile-user-avatar').src = userAvatar;
                
                // Update modals
                document.getElementById('modal-fullname').textContent = userInfo.displayName || userInfo.name || userInfo.email;
                document.getElementById('modal-email').textContent = userInfo.email || 'No email';
                document.getElementById('modal-role').textContent = userInfo.role === 'admin' ? 'Administrator' : 'Member';
                document.getElementById('modal-avatar').src = userAvatar;
                document.getElementById('current-photo').src = userAvatar;
                
                document.getElementById('profile-firstname').value = userInfo.firstName || userInfo.displayName?.split(' ')[0] || '';
                document.getElementById('profile-lastname').value = userInfo.lastName || userInfo.displayName?.split(' ')[1] || '';
                document.getElementById('profile-phone').value = userInfo.phone || '';
                document.getElementById('profile-address').value = userInfo.address || '';
                document.getElementById('profile-bio').value = userInfo.bio || '';
                
                // Update photo modal previews
                document.getElementById('preview-name').textContent = userInfo.displayName || userInfo.name || userInfo.email;
                document.getElementById('preview-email').textContent = userInfo.email || 'No email';
                
                console.log(`User UI updated from localStorage`);
            }
        }

        // Show/Hide sections
        function showUserSection() {
            // Show user profile, hide auth buttons
            document.getElementById('user-profile-section').classList.remove('hidden');
            document.getElementById('auth-buttons-section').classList.add('hidden');
            
            // Mobile version
            document.getElementById('mobile-user-profile').classList.remove('hidden');
            document.getElementById('mobile-auth-buttons').classList.add('hidden');
            
            updateUI();
        }

        function showAuthSection() {
            // Show auth buttons, hide user profile
            document.getElementById('user-profile-section').classList.add('hidden');
            document.getElementById('auth-buttons-section').classList.remove('hidden');
            
            // Mobile version
            document.getElementById('mobile-user-profile').classList.add('hidden');
            document.getElementById('mobile-auth-buttons').classList.remove('hidden');
        }

        // ==============================
        // PHOTO MODAL BACK NAVIGATION SYSTEM
        // ==============================

        // Open photo modal with proper state reset
        function openPhotoModal() {
            document.getElementById('photo-modal').classList.remove('hidden');
            const userDropdown = document.getElementById('user-dropdown');
            if (userDropdown) {
                userDropdown.classList.remove('show');
            }
            document.body.style.overflow = 'hidden';
            
            // Reset to upload state
            resetPhotoModal();
        }

        // Reset photo modal to initial state
        function resetPhotoModal() {
            currentPhotoState = 'upload';
            currentUploadedImage = null;
            
            // Show only upload section
            document.getElementById('current-photo-section').classList.remove('hidden');
            document.getElementById('crop-section').classList.add('hidden');
            document.getElementById('preview-section').classList.add('hidden');
            
            // Update back button visibility
            const backBtn = document.getElementById('photo-back-btn');
            if (backBtn) {
                backBtn.style.visibility = 'hidden';
            }
            
            // Reset current photo to user's current photo
            if (currentUser) {
                const userAvatar = currentUser.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.displayName || currentUser.email)}&background=random`;
                document.getElementById('current-photo').src = userAvatar;
            }
            
            // Reset file input
            document.getElementById('photo-upload').value = '';
            document.getElementById('upload-text').textContent = 'Drag & drop your photo here';
        }

        // Close photo modal
        function closePhotoModal() {
            document.getElementById('photo-modal').classList.add('hidden');
            document.body.style.overflow = '';
            resetPhotoModal();
        }

        // Handle back button in photo modal
        function handlePhotoModalBack() {
            switch(currentPhotoState) {
                case 'crop':
                    // Go back to upload from crop
                    backToUpload();
                    break;
                case 'preview':
                    // Go back to crop from preview
                    backToCrop();
                    break;
                default:
                    // If in upload state, close modal
                    closePhotoModal();
            }
        }

        // Navigate to crop section
        function navigateToCrop(imageSrc) {
            currentPhotoState = 'crop';
            currentUploadedImage = imageSrc;
            
            // Hide upload, show crop
            document.getElementById('current-photo-section').classList.add('hidden');
            document.getElementById('crop-section').classList.remove('hidden');
            document.getElementById('preview-section').classList.add('hidden');
            
            // Set image for cropping
            document.getElementById('crop-image').src = imageSrc;
            
            // Show back button
            const backBtn = document.getElementById('photo-back-btn');
            if (backBtn) {
                backBtn.style.visibility = 'visible';
            }
            
            // Initialize crop
            initializeCrop();
        }

        // Navigate to preview section
        function navigateToPreview(imageSrc) {
            currentPhotoState = 'preview';
            
            // Hide crop, show preview
            document.getElementById('current-photo-section').classList.add('hidden');
            document.getElementById('crop-section').classList.add('hidden');
            document.getElementById('preview-section').classList.remove('hidden');
            
            // Set final preview image
            document.getElementById('final-preview').src = imageSrc;
            document.getElementById('preview-avatar').src = imageSrc;
        }

        // Back to upload from crop
        function backToUpload() {
            currentPhotoState = 'upload';
            
            document.getElementById('current-photo-section').classList.remove('hidden');
            document.getElementById('crop-section').classList.add('hidden');
            document.getElementById('preview-section').classList.add('hidden');
            
            // Hide back button
            const backBtn = document.getElementById('photo-back-btn');
            if (backBtn) {
                backBtn.style.visibility = 'hidden';
            }
        }

        // Back to crop from preview
        function backToCrop() {
            navigateToCrop(currentUploadedImage);
        }

        // Handle upload next button
        function handleUploadNext() {
            const fileInput = document.getElementById('photo-upload');
            const file = fileInput.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    navigateToCrop(e.target.result);
                };
                reader.readAsDataURL(file);
            } else {
                // If no file, show error
                showNotification('Please select a photo first', 'error');
            }
        }

        // Crop functionality
        function initializeCrop() {
            // Simple crop initialization
            const cropImage = document.getElementById('crop-image');
            const cropZoom = document.getElementById('crop-zoom');
            
            if (cropImage && cropZoom) {
                cropZoom.addEventListener('input', function() {
                    const scale = this.value;
                    cropImage.style.transform = `scale(${scale})`;
                });
                
                // Reset to default
                cropImage.style.transform = 'scale(1)';
                cropZoom.value = 1;
            }
        }

        function cropRotate(degrees) {
            const cropImage = document.getElementById('crop-image');
            if (cropImage) {
                const currentRotation = cropImage.style.transform.match(/rotate\(([-]?\d+)deg\)/);
                const currentAngle = currentRotation ? parseInt(currentRotation[1]) : 0;
                const newAngle = currentAngle + degrees;
                cropImage.style.transform = cropImage.style.transform.replace(/rotate\(([-]?\d+)deg\)/, '') + ` rotate(${newAngle}deg)`;
            }
        }

        function resetCrop() {
            const cropImage = document.getElementById('crop-image');
            const cropZoom = document.getElementById('crop-zoom');
            
            if (cropImage) {
                cropImage.style.transform = 'scale(1) rotate(0deg)';
            }
            if (cropZoom) {
                cropZoom.value = 1;
            }
        }

        function cancelCrop() {
            backToUpload();
        }

        function applyCrop() {
            // For demo purposes, we'll just use the uploaded image
            // In a real app, you would actually crop the image here
            navigateToPreview(currentUploadedImage);
        }

        // Save final photo
        function saveFinalPhoto() {
            const finalImage = document.getElementById('final-preview').src;
            
            if (!currentUser) return;
            
            // Update user data
            const success = updateUserData({ 
                photoURL: finalImage,
                photoData: finalImage // Store base64 data
            });
            
            if (success) {
                showNotification('Profile photo updated successfully!', 'success');
            } else {
                showNotification('Failed to update photo', 'error');
            }
            
            closePhotoModal();
        }

        // Update the simulateUpload function to navigate to crop
        function simulateUpload(file) {
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const uploadProgress = document.getElementById('upload-progress');
            const uploadText = document.getElementById('upload-text');
            
            // Validate file size (5MB max)
            if (file.size > 5 * 1024 * 1024) {
                showNotification('Image must be less than 5MB', 'error');
                return;
            }
            
            // Show progress bar
            uploadProgress.classList.remove('hidden');
            uploadText.textContent = `Selected: ${file.name}`;
            
            // Simulate upload progress
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressBar.style.width = `${progress}%`;
                progressText.textContent = `Uploading... ${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    progressText.textContent = 'Upload complete!';
                    
                    // After upload completes, read the file and navigate to crop
                    setTimeout(() => {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const imageSrc = e.target.result;
                            uploadProgress.classList.add('hidden');
                            uploadText.textContent = 'Drag & drop your photo here';
                            progressBar.style.width = '0%';
                            
                            // Store the file in the photo upload input
                            const dataTransfer = new DataTransfer();
                            dataTransfer.items.add(file);
                            document.getElementById('photo-upload').files = dataTransfer.files;
                            
                            // Navigate to crop section
                            navigateToCrop(imageSrc);
                        };
                        reader.readAsDataURL(file);
                    }, 500);
                }
            }, 100);
        }

        // Update selectAvatar function
        function selectAvatar(color) {
            if (!currentUser) return;
            
            const userName = currentUser.displayName || currentUser.name || currentUser.email;
            const photoURL = `https://ui-avatars.com/api/?name=${encodeURIComponent(userName)}&background=${color}&color=fff`;
            
            // Update user data
            updateUserData({ photoURL: photoURL });
            showNotification('Avatar selected successfully!', 'success');
            closePhotoModal();
        }

        // ==============================
        // EXISTING MODAL FUNCTIONS (Updated)
        // ==============================

        function openProfileModal() {
            document.getElementById('profile-modal').classList.remove('hidden');
            const userDropdown = document.getElementById('user-dropdown');
            if (userDropdown) {
                userDropdown.classList.remove('show');
            }
            document.body.style.overflow = 'hidden';
        }

        function closeProfileModal() {
            document.getElementById('profile-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        function openPasswordModal() {
            document.getElementById('password-modal').classList.remove('hidden');
            const userDropdown = document.getElementById('user-dropdown');
            if (userDropdown) {
                userDropdown.classList.remove('show');
            }
            document.body.style.overflow = 'hidden';
        }

        function closePasswordModal() {
            document.getElementById('password-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        // Update profile
        function updateProfile() {
            const firstName = document.getElementById('profile-firstname').value;
            const lastName = document.getElementById('profile-lastname').value;
            const phone = document.getElementById('profile-phone').value;
            const address = document.getElementById('profile-address').value;
            const bio = document.getElementById('profile-bio').value;
            
            if (!currentUser) return;
            
            const updates = {
                firstName: firstName,
                lastName: lastName,
                displayName: `${firstName} ${lastName}`,
                phone: phone,
                address: address,
                bio: bio
            };
            
            const success = updateUserData(updates);
            
            if (success) {
                showNotification('Profile updated successfully!', 'success');
            } else {
                showNotification('Failed to update profile', 'error');
            }
            
            closeProfileModal();
        }

        // Photo upload handlers
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                simulateUpload(file);
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const dropzone = document.getElementById('upload-dropzone');
            dropzone.classList.remove('drag-over');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                const file = files[0];
                if (file.type.startsWith('image/')) {
                    simulateUpload(file);
                } else {
                    showNotification('Please drop an image file (JPG, PNG, GIF)', 'error');
                }
            }
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            const dropzone = document.getElementById('upload-dropzone');
            dropzone.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.stopPropagation();
            const dropzone = document.getElementById('upload-dropzone');
            dropzone.classList.remove('drag-over');
        }

        // Change password
        function handleChangePassword(e) {
            e.preventDefault();
            
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-new-password').value;
            
            if (!currentUser) return;
            
            if (newPassword.length < 6) {
                document.getElementById('password-error').textContent = 'New password must be at least 6 characters';
                document.getElementById('password-error').classList.remove('hidden');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                document.getElementById('password-error').textContent = 'New passwords do not match';
                document.getElementById('password-error').classList.remove('hidden');
                return;
            }
            
            // Update local user password
            if (currentUser.password !== currentPassword) {
                document.getElementById('password-error').textContent = 'Current password is incorrect';
                document.getElementById('password-error').classList.remove('hidden');
                return;
            }
            
            updateUserData({ password: newPassword });
            
            document.getElementById('password-success').textContent = 'Password updated successfully!';
            document.getElementById('password-success').classList.remove('hidden');
            document.getElementById('password-error').classList.add('hidden');
            
            showNotification('Password updated successfully!', 'success');
            
            // Clear form
            document.getElementById('change-password-form').reset();
            
            setTimeout(() => {
                closePasswordModal();
            }, 1500);
        }

        function goToDashboard() {
            if (currentUser && currentUser.role === 'admin') {
                window.location.href = 'dashboard.html';
            } else {
                showNotification('You need admin privileges to access the dashboard', 'error');
            }
        }

        // Logout
        function logout() {
            // Clear session storage
            sessionStorage.removeItem('currentUser');
            currentUser = null;
            
            // Update UI
            showAuthSection();
            showNotification('Logged out successfully', 'info');
            
            // Close dropdowns
            const userDropdown = document.getElementById('user-dropdown');
            if (userDropdown) {
                userDropdown.classList.remove('show');
            }
            
            // Close mobile menu if open
            const mobileMenu = document.getElementById('mobileMenu');
            if (mobileMenu && mobileMenu.classList.contains('active')) {
                mobileMenu.classList.remove('active');
                const icon = document.querySelector('#mobileMenuButton i');
                if (icon) {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            }
        }

        // ==============================
        // CHECK FOR AUTH REDIRECT
        // ==============================

        function checkForAuthRedirect() {
            const urlParams = new URLSearchParams(window.location.search);
            const authSuccess = urlParams.get('auth');
            const view = urlParams.get('view');
            
            if (authSuccess === 'success') {
                // Remove the parameter from URL
                const url = new URL(window.location);
                url.searchParams.delete('auth');
                url.searchParams.delete('view');
                window.history.replaceState({}, '', url);
                
                // Check login status
                checkLoginStatus();
                
                // Show welcome message
                if (currentUser) {
                    showNotification(`Welcome ${currentUser.displayName || currentUser.email}!`, 'success');
                }
            }
            
            // Check if we should redirect to auth page with specific view
            if (view && (view === 'login' || view === 'signup')) {
                window.location.href = `auth.html?view=${view}`;
            }
        }

        // ==============================
        // EVENT LISTENERS
        // ==============================

        // Toggle user dropdown
        const userMenuBtn = document.getElementById('user-menu-btn');
        if (userMenuBtn) {
            userMenuBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                document.getElementById('user-dropdown').classList.toggle('show');
            });
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function() {
            const userDropdown = document.getElementById('user-dropdown');
            if (userDropdown) {
                userDropdown.classList.remove('show');
            }
        });

        // Prevent dropdown close when clicking inside
        const userDropdown = document.getElementById('user-dropdown');
        if (userDropdown) {
            userDropdown.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        }

        // Password form event listener
        const passwordForm = document.getElementById('change-password-form');
        if (passwordForm) {
            passwordForm.addEventListener('submit', handleChangePassword);
        }

        // ==============================
        // EXISTING HOMEPAGE FUNCTIONALITY
        // ==============================

        document.addEventListener('DOMContentLoaded', function() {
            // Initialize authentication
            checkLoginStatus();
            checkForAuthRedirect();
            
            // Initialize photo upload
            const photoUpload = document.getElementById('photo-upload');
            if (photoUpload) {
                photoUpload.addEventListener('change', handleFileSelect);
            }
            
            // Initialize photo back button
            const photoBackBtn = document.getElementById('photo-back-btn');
            if (photoBackBtn) {
                photoBackBtn.addEventListener('click', handlePhotoModalBack);
            }
            
            // Initialize upload next button
            const uploadNextBtn = document.getElementById('upload-next-btn');
            if (uploadNextBtn) {
                uploadNextBtn.addEventListener('click', handleUploadNext);
            }
            
            // Initialize drag and drop
            const dropzone = document.getElementById('upload-dropzone');
            if (dropzone) {
                dropzone.addEventListener('dragover', handleDragOver);
                dropzone.addEventListener('dragleave', handleDragLeave);
                dropzone.addEventListener('drop', handleDrop);
            }
            
            // Mobile menu toggle
            const mobileMenuButton = document.getElementById('mobileMenuButton');
            const mobileMenu = document.getElementById('mobileMenu');
            
            if (mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', function() {
                    mobileMenu.classList.toggle('active');
                    // Toggle menu icon
                    const icon = mobileMenuButton.querySelector('i');
                    if (icon.classList.contains('fa-bars')) {
                        icon.classList.remove('fa-bars');
                        icon.classList.add('fa-times');
                    } else {
                        icon.classList.remove('fa-times');
                        icon.classList.add('fa-bars');
                    }
                });
            }
            
            // Close mobile menu when clicking outside
            document.addEventListener('click', function(event) {
                if (mobileMenu && mobileMenu.classList.contains('active') && 
                    !mobileMenu.contains(event.target) && 
                    !mobileMenuButton.contains(event.target)) {
                    mobileMenu.classList.remove('active');
                    const icon = mobileMenuButton.querySelector('i');
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
            
            // Mobile dropdown functionality
            const mobileDropdownButtons = document.querySelectorAll('.mobile-dropdown-btn');
            mobileDropdownButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const content = this.nextElementSibling;
                    content.classList.toggle('active');
                    
                    // Rotate arrow icon
                    const icon = this.querySelector('i');
                    icon.classList.toggle('fa-chevron-down');
                    icon.classList.toggle('fa-chevron-up');
                });
            });
            
            // Desktop dropdown functionality
            const dropdownButtons = document.querySelectorAll('.dropdown-btn');
            dropdownButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const dropdownId = this.getAttribute('data-dropdown');
                    const dropdown = document.getElementById(`${dropdownId}-dropdown`);
                    dropdown.classList.toggle('active');
                });
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', function(event) {
                dropdownButtons.forEach(button => {
                    const dropdownId = button.getAttribute('data-dropdown');
                    const dropdown = document.getElementById(`${dropdownId}-dropdown`);
                    if (dropdown && !button.contains(event.target) && !dropdown.contains(event.target)) {
                        dropdown.classList.remove('active');
                    }
                });
            });
            
            // Modal functionality
            window.openModal = function(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                }
            };
            
            window.closeModal = function(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('active');
                    document.body.style.overflow = '';
                }
            };
            
            // Close modal when clicking outside
            document.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.classList.remove('active');
                    document.body.style.overflow = '';
                }
            });
            
            // Scroll progress bar
            window.addEventListener('scroll', function() {
                const scrollProgress = document.getElementById('scrollProgress');
                if (scrollProgress) {
                    const windowHeight = window.innerHeight;
                    const documentHeight = document.documentElement.scrollHeight - windowHeight;
                    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    const scrollPercentage = (scrollTop / documentHeight) * 100;
                    scrollProgress.style.width = scrollPercentage + '%';
                }
                
                // Navbar scroll effect
                const navbar = document.getElementById('mainNav');
                if (navbar) {
                    if (window.scrollY > 100) {
                        navbar.classList.add('nav-scrolled');
                    } else {
                        navbar.classList.remove('nav-scrolled');
                    }
                }
            });
            
            // Counter animation
            function animateCounters() {
                const counters = document.querySelectorAll('.counter');
                counters.forEach(counter => {
                    const target = parseInt(counter.getAttribute('data-target'));
                    const duration = 2000; // 2 seconds
                    const step = target / (duration / 16); // 60fps
                    let current = 0;
                    
                    const timer = setInterval(() => {
                        current += step;
                        if (current >= target) {
                            counter.textContent = target.toLocaleString();
                            clearInterval(timer);
                        } else {
                            counter.textContent = Math.floor(current).toLocaleString();
                        }
                    }, 16);
                });
            }
            
            // Intersection Observer for fade-in animations
            const fadeElements = document.querySelectorAll('.fade-in');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        // Animate counters when they come into view
                        if (entry.target.querySelector('.counter')) {
                            animateCounters();
                        }
                    }
                });
            }, { threshold: 0.1 });
            
            fadeElements.forEach(element => {
                observer.observe(element);
            });
            
            // Donation amount buttons
            const donationAmounts = document.querySelectorAll('.donation-amount');
            const customAmount = document.getElementById('customAmount');
            
            donationAmounts.forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all buttons
                    donationAmounts.forEach(btn => btn.classList.remove('bg-primary-blue', 'text-white'));
                    // Add active class to clicked button
                    this.classList.add('bg-primary-blue', 'text-white');
                    // Set custom amount value
                    customAmount.value = this.getAttribute('data-amount');
                });
            });
            
            // Payment method selection
            const paymentMethod = document.getElementById('paymentMethod');
            const paymentFields = document.querySelectorAll('.payment-fields');
            
            if (paymentMethod) {
                paymentMethod.addEventListener('change', function() {
                    // Hide all payment fields
                    paymentFields.forEach(field => {
                        field.classList.remove('active');
                    });
                    
                    // Show selected payment field
                    const selectedMethod = this.value;
                    document.getElementById(`${selectedMethod}Fields`).classList.add('active');
                });
            }
            
            // Form submission handlers
            const forms = document.querySelectorAll('form');
            forms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    // Show success notification
                    showNotification('Form submitted successfully!', 'success');
                    // Close modal if it's inside one
                    const modal = this.closest('.modal');
                    if (modal) {
                        closeModal(modal.id);
                    }
                });
            });
            
            // Initialize counters if they're in the initial viewport
            if (document.querySelector('.counter')) {
                const firstCounter = document.querySelector('.counter');
                const rect = firstCounter.getBoundingClientRect();
                if (rect.top < window.innerHeight && rect.bottom >= 0) {
                    animateCounters();
                }
            }
            
            // Log system status
            console.log('Authentication System Ready');
            console.log('- Local Storage: Available');
            console.log('- Photo Upload System: Ready with Back Navigation');
            console.log('- User Profile Management: Integrated');
        });
    </script>
</body>
</html>